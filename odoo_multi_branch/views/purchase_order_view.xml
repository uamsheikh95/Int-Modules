<?xml version="1.0" encoding="utf-8"?>
<odoo>
		<data>
				<record id="view_purchase_order_form_company_branch" model="ir.ui.view">
						<field name="name">purchase.order.company.branch</field>
						<field name="model">purchase.order</field>
						<field name="inherit_id" ref="purchase.purchase_order_form"/>
						<field name="arch" type="xml">
								<xpath expr="//notebook/page/field[@name='order_line']/tree/field[@name='account_analytic_id']" position="after">
										<field name="company_branch_id" invisible="1" widget="selection" options="{'no_create': True}"/>
								</xpath>

								<xpath expr="//field[@name='partner_id']" position="replace">
									<field name="partner_id" widget="res_partner_many2one" context="{'search_default_supplier':1, 'default_supplier':1, 'default_customer':0, 'show_vat': True}"
											placeholder="Name, TIN, Email, or Reference" options="{'no_create': True}"
									/>
								</xpath>
								<xpath expr="//field[@name='company_id']" position="after">
										<field name="company_branch_id" groups="odoo_multi_branch.group_multi_branches" widget="selection" options="{'no_create': True}" />
								</xpath>
						</field>
				</record>

				<!-- Branch order tree -->
				<record id="view_purchase_order_list_company_branch" model="ir.ui.view">
						<field name="name">purchase.order.company.branch</field>
						<field name="model">purchase.order</field>
						<field name="inherit_id" ref="purchase.purchase_order_tree"/>
						<field name="arch" type="xml">
							<xpath expr="//field[@name='state']" position="after">
									<field name="company_branch_id" groups="odoo_multi_branch.group_multi_branches" widget="selection" options="{'no_create': True}" />
							</xpath>
						</field>
				</record>

				<record id="view_purchase_order_view_list_company_branch" model="ir.ui.view">
						<field name="name">purchase.order.company.branch</field>
						<field name="model">purchase.order</field>
						<field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
						<field name="arch" type="xml">
							<xpath expr="//field[@name='state']" position="after">
									<field name="company_branch_id" groups="odoo_multi_branch.group_multi_branches" widget="selection" options="{'no_create': True}" />
							</xpath>
						</field>
				</record>

				<record id="view_purchase_order_filter_company_branch" model="ir.ui.view">
						<field name="name">purchase.order.company.branch</field>
						<field name="model">purchase.order</field>
						<field name="inherit_id" ref="purchase.view_purchase_order_filter"/>
						<field name="arch" type="xml">
								<xpath expr="//search" position="inside">
										<field name="company_branch_id" groups="odoo_multi_branch.group_multi_branches"/>
								</xpath>
								<xpath expr="//search" position="inside">
										<filter name="company_branch_id" string="Branch" domain="[]" context="{'group_by':'company_branch_id'}"/>
								</xpath>
						</field>
				</record>

		</data>
</odoo>
