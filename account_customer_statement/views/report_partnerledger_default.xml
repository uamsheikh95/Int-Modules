<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="report_partnerledger_custom">
		<t t-call="web.html_container">
				<t t-set="data_report_margin_top" t-value="12"/>
				<t t-set="data_report_header_spacing" t-value="9"/>
				<t t-set="data_report_dpi" t-value="110"/>
				<t t-foreach="docs" t-as="o">
						<t t-call="web.internal_layout">
								<div class="page">
										<h2>Statement</h2>

										<div class="row col">
												<div class="col-3">
														<strong>Company:</strong>
														<p t-esc="res_company.name"/>
												</div>
												<div class="col-3">
														<t t-if="data['form']['date_from']"><strong>Date from :</strong> <span t-esc="data['form']['date_from']"/><br/></t>
														<t t-if="data['form']['date_to']"><strong>Date to :</strong> <span t-esc="data['form']['date_to']"/></t>
												</div>
												<div class="col-3">
														<strong>Target Moves:</strong>
														<p t-if="data['form']['target_move'] == 'all'">All Entries</p>
														<p t-if="data['form']['target_move'] == 'posted'">All Posted Entries</p>
												</div>
										</div>

										<table class="table table-condensed mt32">
												<thead>
														<tr style="background-color:#F9E79F">
																<th>Date</th>
																<th>JRNL</th>
																<th>Acc</th>
																<th>Description</th>
																<th class="text-right">Debit</th>
																<th class="text-right">Credit</th>
																<th class="text-right">Balance</th>
																<th t-if="data['form']['amount_currency']">Currency</th>
														</tr>
												</thead>
												<tbody>
													<t t-if="data['form']['date_from']">
														<t t-set="balance_forward" t-value="sum_open_balance(data, o, 'debit - credit')"/>
														<t t-set="current_balance" t-value="sum_partner(data, o, 'debit - credit')"/>
													</t>
													<tr>
															<td colspan="4">
																			<strong t-esc="o.ref"/>
																			- <strong t-esc="o.name"/>
															</td>
															<td class="text-right">
																	</td>
															<td class="text-right">
																	</td>
															<td class="text-right">
																	</td>
													</tr>
													<tr t-if="data['form']['date_from']" style="color:red">
															<td colspan="4">
															 <strong>-Balance Forward</strong>
															</td>
															<td class="text-right">
															    <!--
																	<strong t-esc="'{0:,.2f}'.format(sum_open_balance(data, o, 'debit'))" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>														
															     -->
															</td>
															<td class="text-right">
																<!--	
																	<strong t-esc="'{0:,.2f}'.format(sum_open_balance(data, o, 'debit'))" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
															     -->
															</td>
															<td class="text-right">
																	
																	<strong t-esc="'{0:,.2f}'.format(balance_forward)" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
															</td>
													</tr>




													
													<t t-if="data['form']['report_type']=='detail'">
														<tr t-foreach="lines(data, o)" t-as="line" style="font-weight:bold">
																<td nowrap='nowrap'>
																		<span t-esc="line['date']"/>
																</td>
																<td nowrap='nowrap'>
																		<span t-esc="line['move_name']"/>
																</td>
																<td nowrap='nowrap'>
																		<span t-esc="line['a_code']"/>
																</td>
																<td colospan="3" nowrap='nowrap'>
																		<span t-esc="line['displayed_name']"/>
																		<t t-foreach="get_invoice(line['move_name'])" t-as="invoice_line">
																				<br></br><span t-esc="invoice_line.name"/> <span t-esc="invoice_line.quantity"/> <span t-esc="invoice_line.uom_id.name"/>  @ <span t-esc="invoice_line.currency_id.symbol"/> <span t-esc="invoice_line.price_unit" t-esc-options='{"widget": "monetary"}'/> = <span t-esc="invoice_line.price_subtotal" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																		</t>
																</td>
																<td class="text-right" nowrap='nowrap'>
																		<span t-esc="'{0:,.2f}'.format(line['debit'])" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td class="text-right" nowrap='nowrap'>
																		<span t-esc="'{0:,.2f}'.format(line['credit'])" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td class="text-right" nowrap='nowrap'>
																		<span t-esc="'{0:,.2f}'.format(line['progress'])" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td t-if="data['form']['amount_currency']" nowrap='nowrap'>
																		<span t-esc="'{0:,.2f:,}'.format(line['amount_currency'])" /> <span t-esc="line['currency_code']" />
																</td>
														</tr>
													</t>




													<t t-if="data['form']['report_type']=='summary'">
														<tr t-foreach="lines(data, o)" t-as="line">
																<td>
																		<span t-esc="line['date']"/>
																</td>
																<td>
																		<span t-esc="line['code']"/>
																</td>
																<td>
																		<span t-esc="line['a_code']"/>
																</td>
																<td>
																		<span t-esc="line['displayed_name']"/>
																</td>
																<td class="text-right">
																		<span t-esc="line['debit']" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td class="text-right">
																		<span t-esc="line['credit']" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td class="text-right">
																		<span t-esc="line['progress']" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
																</td>
																<td t-if="data['form']['amount_currency']">
																		<span t-esc="line['amount_currency']" /> <span t-esc="line['currency_code']" />
																</td>
														</tr>
													</t>
													
													

													<tr>
															<td colspan="4">
																	<strong>-Balance</strong>
															</td>
															<td class="text-right">
																	
																	<strong t-esc="'{0:,.2f}'.format(sum_partner(data, o, 'debit'))" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
															</td>
															<td class="text-right">
																<strong t-esc="'{0:,.2f}'.format(sum_partner(data, o, 'debit'))" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
															</td>
															<td class="text-right">
																	
																	<strong t-esc="'{0:,.2f}'.format(current_balance)" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>

															</td>
													</tr>													
													
													
													
													
													
													
													
														<t t-if="data['form']['date_from']">
															<tr style="color:#D7DBDD">
																	<td colspan="4">
																					<strong>Total Amount Due</strong>
																	</td>
																	<td class="text-right">
																			</td>
																	<td class="text-right">
																			</td>
																	<td class="text-right">
																			<strong><span t-esc="current_balance + balance_forward" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/></strong>
																			</td>
															</tr>
														</t>
												</tbody>
										</table>
								</div>
						</t>
				</t>
		</t>
</template>
</odoo>
